<script>
    document.title = "TechFi - Profile";
</script>
{{!< default}}

<iframe id="custom-profile" class="custom-iframe" src="" title="admin-news"></iframe>

<script>
    document.title = "TechFi - Profile";
    let integrationMemberJwt = localStorage.getItem(INTEGRATION_JWT_MEMBER_KEY);
    console.log(integrationMemberJwt);
    if (!integrationMemberJwt){
        window.location.replace("#/portal/signup");
    }else {
        let PageProfile = `${integrationFrontend}/profile/${integrationMemberJwt}`;
        console.log(PageProfile);

        // PageProfile = 'https://staging.i-frontent.techfi.tech/profile/919da796-d2ee-46b1-970e-33fb731ec13a';

        function addCode() {
            document.getElementById('custom-profile').setAttribute('src', PageProfile);
        }

        let elementId = 'custom-profile';
        let attrKey = 'src';
        let attrValue = PageProfile;

        addValueToAttr(elementId, attrKey, attrValue);

        /* function checkIframeLoaded() {
            // Get a handle to the iframe element
            var iframe = document.getElementById('custom-profile');
            var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

            // Check if loading is complete
            if (  iframeDoc.readyState  == 'complete' ) {
                //iframe.contentWindow.alert("Hello");
                iframe.contentWindow.onload = function(){
                   console.log("I am loaded");
                };
                // The loading is complete, call the function we want executed once the iframe is loaded
                window.location.reload();
                return;
            } 

            // If we are here, it is not loaded. Set things up so we check   the status again in 100 milliseconds
            window.setTimeout(checkIframeLoaded, 1000);
        }
        checkIframeLoaded();*/
    }

    async function removePortal() {
        while(!document.querySelector('#ghost-portal-root')) {
            await new Promise(r => setTimeout(r, 10));
        }
        document.getElementById('ghost-portal-root').remove();
    }
    removePortal();
</script>